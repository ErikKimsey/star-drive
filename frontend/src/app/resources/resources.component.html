<div
  id="hero"
  class="gradient-overlay container"
>
  <h1>Training &amp; Resources</h1>
  <div
    class="row"
    fxLayout.lt-sm="column"
    fxLayout.gt-xs="row wrap"
    fxLayoutGap="40px"
    fxLayoutAlign="center auto"
  >
    <div
      *ngFor="let resourceType of resourceTypes"
      class="border-box-tile {{resourceType.name.toLowerCase()}}"
      fxFlex.gt-sm="calc(33% - 160px)"
      fxFlex.sm="calc(50% - 120px)"
    >
      <div
        class="border-box-tile-inner"
        [routerLink]="[ '/search' ]"
        [queryParams]="{Type: resourceType.label}"
      >
        <app-type-icon
          [iconType]="resourceType.name"
          [size]="2"
        ></app-type-icon>
        <div class="border-box-tile-label">{{resourceType.label}}</div>
        <app-details-link url="/search" label=""></app-details-link>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div
    class="row"
    style="width: 100%"
  >
    <app-resource-add-button [currentUser]="currentUser"></app-resource-add-button>
    <h1>Resources Near You</h1>
    <agm-map
      *ngIf="!loading"
      [latitude]="mapLoc ? mapLoc.lat : defaultLoc.lat"
      [longitude]="mapLoc ? mapLoc.lng : defaultLoc.lng"
      [streetViewControl]="false"
      mapTypeId="roadmap"
      [zoom]="7"
      (mapReady)="mapLoad($event)"
    >
      <agm-marker
        *ngIf="mapLoc"
        [latitude]="mapLoc.lat"
        [longitude]="mapLoc.lng"
        iconUrl="/assets/map/your-location.svg"
      ></agm-marker>

      <ng-container *ngIf="locQuery && locQuery.hits">
        <agm-marker-cluster imagePath="/assets/map/m">
          <ng-container *ngFor="let hit of locQuery.hits">
            <agm-marker
              *ngIf="hit.hasCoords()"
              [latitude]="hit.latitude"
              [longitude]="hit.longitude"
            >
              <agm-info-window>
                <h4>{{hit.title}}</h4>
                <p>{{hit.description}}</p>
                <a
                  class="chevron-link"
                  [routerLink]="['/' + hit.type.toLowerCase() + '/' + hit.id]"
                  routerLinkActive="router-link-active"
                >{{hit.type}} Details - {{hit.milesFrom(mapLoc)}}mi</a>
              </agm-info-window>
            </agm-marker>
          </ng-container>
        </agm-marker-cluster>
      </ng-container>
    </agm-map>
    <app-loading *ngIf="loading"></app-loading>
  </div>

  <div
    class="row"
    *ngIf="mostRecentsLoaded()"
  >
    <h1>Recently added</h1>
    <app-search-result
      *ngFor="let r of mostRecentsList()"
      [hit]="r"
      [mapLoc]="mapLoc"
    ></app-search-result>
  </div>

  <div class="row">
    <h1>Resource partners</h1>
    <p>We are partnering with the following initiatives and organizations to identify resources that will improve
      outcomes for individuals with autism and their families.</p>
    <app-accordion
      *ngFor="let rg of resourceGatherers"
      [item]="rg"
      [ngClass]="{'resource-gatherer': true}"
    ></app-accordion>
  </div>

</div>
